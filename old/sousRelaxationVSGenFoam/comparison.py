import pandas as pd
import matplotlib.pyplot as plt

# Read the Excel file
df = pd.read_excel("BWR\BWR_Project\driftFluxModel\sousRelaxationVSGenFoam\Firstopenfoam.xlsx")

# Create empty lists for each column
columns = df.columns.tolist()
data = [[] for _ in columns]

# Iterate over each row and append values to the corresponding list
for index, row in df.iterrows():
    for i, col in enumerate(columns):
        data[i].append(row[col])

# Plot each column according to the first column
x = data[0]
zList = [0.0, 0.05516666666666667, 0.11033333333333334, 0.1655, 0.22066666666666668, 0.2758333333333334, 0.331, 0.38616666666666666, 0.44133333333333336, 0.49650000000000005, 0.5516666666666667, 0.6068333333333333, 0.662, 0.7171666666666667, 0.7723333333333333, 0.8275, 0.8826666666666667, 0.9378333333333334, 0.9930000000000001, 1.0481666666666667, 1.1033333333333335, 1.1585, 1.2136666666666667, 1.2688333333333335, 1.324, 1.3791666666666667, 1.4343333333333335, 1.4895, 1.5446666666666666, 1.5998333333333334]
U = [4.68292412, 4.682923269914198, 4.681161742312741, 4.67940404137743, 4.677650151860188, 4.6759000585907895, 4.674153746481544, 4.672411904282555, 4.670674391037348, 4.668940445897071, 4.667210084594149, 4.6654844280333565, 4.663762641582627, 4.6620444822116465, 4.66470354955905, 4.870007046346109, 5.024571699356097, 5.204428224716265, 5.389912663467558, 5.576570094330741, 5.7636276329847655, 5.951662809110173, 6.140995042998913, 6.331696572866315, 6.523774612947431, 6.717221200003458, 6.91202615542256, 7.108180098793077, 7.305674908744481, 7.504503616194086]
P = [15230028.531453427, 15230017.876636565, 15217677.759682218, 15205347.634610288, 15193027.493364137, 15180717.327893449, 15168417.13015421, 15156126.88988836, 15143846.599463923, 15131576.25321083, 15119315.84301354, 15107065.357276423, 15094824.79058284, 15082594.135654097, 15070332.2995218, 15056456.014088888, 15041201.14577497, 15024703.182975989, 15006768.613664351, 14987520.517068531, 14967054.59312335, 14945454.401808307, 14922793.994031833, 14899138.861441763, 14874548.975959828, 14849079.881986164, 14822783.266728953, 14795707.348927991, 14767897.188160617, 14739394.95]
T = [602.6856235331478, 603.6813884005375, 604.6645568957903, 605.6338589729726, 606.5894159078755, 607.5317474531989, 608.4594455814964, 609.3730209537522, 610.2719987539601, 611.1558004596991, 612.0238555853689, 612.875586453318, 613.7099889447381, 613.9844075336325, 613.978336670654, 613.972704992042, 613.9671394705915, 613.961730015362, 613.9564900374556, 613.9514073716286, 613.9464675306551, 613.94165710203, 613.9369649183565, 613.932381051305, 613.9278969188351, 613.9235048043155, 613.9191978289408, 613.9149698136795, 613.9108151364061, 613.9067287213829]
epsilon = [0.00064467, 0.00064467, 0.00064467, 0.00064467, 0.00064467, 0.00064467, 0.00064467, 0.00064468, 0.00064468, 0.00064468, 0.00064468, 0.00064468, 0.00064468, 0.03162931, 0.06990657, 0.10622353, 0.14149819, 0.17458368, 0.20552905, 0.23456422, 0.26188781, 0.28766571, 0.31203037, 0.3351004, 0.35697627, 0.37774963, 0.39750232, 0.41630793, 0.43423312, 0.45133848]

for i in range(len(data[7])):
    data[7][i] = (1/0.434492) * data[7][i]

#Pressure
fig1 = plt.figure()
y = data[1]
plt.plot(x, y, label='GeN-FOAM ' + columns[1])
plt.plot(zList, P, label='DFM ' + columns[1])
# Add labels and legend
plt.xlabel(columns[0])
plt.ylabel('Pressure (MPa)')
plt.legend()

#Temperature
fig2 = plt.figure()
y = data[3]
plt.plot(x, y, label='GeN-FOAM ' + columns[3])
plt.plot(zList, T, label='DFM ' + columns[3])
# Add labels and legend
plt.xlabel(columns[0])
plt.ylabel('Temperature (K)')
plt.legend()

#Velocity
fig3 = plt.figure()
y = data[5]
plt.plot(x, y, label='GeN-FOAM ' + columns[5])
plt.plot(zList, U, label='DFM ' + columns[5])
# Add labels and legend
plt.xlabel(columns[0])
plt.ylabel('Vitesse (m/s)')
plt.legend()    

#Velocity
fig3 = plt.figure()
y = data[7]
plt.plot(x, y, label='GeN-FOAM ' + columns[7])
plt.plot(zList, epsilon, label='DFM ' + columns[7])
# Add labels and legend
plt.xlabel(columns[0])
plt.ylabel('Void Fraction')
plt.legend()

# Show the plot
plt.show()
